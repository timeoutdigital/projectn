CREATE TABLE event_translation (id BIGINT, name TEXT NOT NULL, vendor_category TEXT NOT NULL, short_description TEXT, description TEXT, booking_url TEXT, lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE event (id BIGINT AUTO_INCREMENT, vendor_id BIGINT NOT NULL, url TEXT, price TEXT, rating FLOAT(18, 2), event_category_id BIGINT NOT NULL, poi_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX event_category_id_idx (event_category_id), INDEX poi_id_idx (poi_id), INDEX vendor_id_idx (vendor_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE event_category (id BIGINT AUTO_INCREMENT, name VARCHAR(50) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE event_media (id BIGINT AUTO_INCREMENT, media_url TEXT NOT NULL, mime_type VARCHAR(255) NOT NULL, event_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX event_id_idx (event_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE event_occurence (id BIGINT AUTO_INCREMENT, vendor_id BIGINT NOT NULL, booking_url TEXT, start DATE NOT NULL, end DATE NOT NULL, utc_offset TIME NOT NULL, event_id BIGINT NOT NULL, poi_id BIGINT NOT NULL, INDEX event_id_idx (event_id), INDEX poi_id_idx (poi_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE event_property (id BIGINT AUTO_INCREMENT, lookup VARCHAR(50) NOT NULL, value VARCHAR(50) NOT NULL, event_id BIGINT NOT NULL, poi_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX poi_id_idx (poi_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE movie (id BIGINT AUTO_INCREMENT, vendor_id BIGINT NOT NULL, name TEXT NOT NULL, genre TEXT NOT NULL, plot TEXT, review TEXT, url TEXT, rating FLOAT(18, 2), age_rating VARCHAR(32), INDEX vendor_id_idx (vendor_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE movie_media (id BIGINT AUTO_INCREMENT, media_url TEXT NOT NULL, mime_type VARCHAR(255) NOT NULL, movie_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX movie_id_idx (movie_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE movie_occurence (id BIGINT AUTO_INCREMENT, start datetime NOT NULL, end datetime, utf_offset TIME NOT NULL, movie_id BIGINT NOT NULL, poi_id BIGINT NOT NULL, INDEX movie_id_idx (movie_id), INDEX poi_id_idx (poi_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE movie_property (id BIGINT AUTO_INCREMENT, lookup VARCHAR(50) NOT NULL, value VARCHAR(50) NOT NULL, movie_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX movie_id_idx (movie_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE poi_translation (id BIGINT, house_no VARCHAR(16), street VARCHAR(128) NOT NULL, city VARCHAR(32) NOT NULL, district VARCHAR(128), country VARCHAR(3) NOT NULL, zips VARCHAR(16), extension VARCHAR(128), lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE poi (id BIGINT AUTO_INCREMENT, vendor_poi_id BIGINT, local_language VARCHAR(10), poi_name VARCHAR(80), additional_address_details VARCHAR(128), country_code VARCHAR(2) NOT NULL, longitude DECIMAL(18, 15) NOT NULL, latitude DECIMAL(18, 15) NOT NULL, email VARCHAR(12), url TEXT, phone VARCHAR(32), phone2 VARCHAR(32), fax VARCHAR(32), language TEXT, vendor_category VARCHAR(128), keywords TEXT, short_description TEXT, description TEXT, public_transport_links TEXT, price_information TEXT, openingtimes TEXT, star_rating TINYINT, rating TINYINT, provider TEXT, poi_category_id BIGINT NOT NULL, poi_parent_category_id BIGINT NOT NULL, vendor_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX vendor_id_idx (vendor_id), INDEX poi_category_id_idx (poi_category_id), INDEX poi_parent_category_id_idx (poi_parent_category_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE poi_category (id BIGINT AUTO_INCREMENT, parent_id BIGINT, name VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX parent_id_idx (parent_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE poi_media (id BIGINT AUTO_INCREMENT, media_url TEXT NOT NULL, mime_type VARCHAR(255) NOT NULL, poi_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX poi_id_idx (poi_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE poi_parent_category (id BIGINT AUTO_INCREMENT, name VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE poi_property (id BIGINT AUTO_INCREMENT, lookup VARCHAR(50) NOT NULL, value VARCHAR(50) NOT NULL, poi_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX poi_id_idx (poi_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE user (id BIGINT AUTO_INCREMENT, vendor_id BIGINT NOT NULL, user_name VARCHAR(32) NOT NULL, user_reputation TINYINT, user_infomation TEXT NOT NULL, comments_relevance FLOAT(18, 2), specialty VARCHAR(128), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX vendor_id_idx (vendor_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE user_content (id BIGINT AUTO_INCREMENT, vendor_ucid VARCHAR(32) NOT NULL, comment_subject TEXT NOT NULL, comment_body TEXT NOT NULL, user_rating FLOAT(18, 2), user_id BIGINT NOT NULL, poi_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), INDEX poi_id_idx (poi_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE vendor (id BIGINT AUTO_INCREMENT, city VARCHAR(15) NOT NULL, language VARCHAR(10) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
ALTER TABLE event_translation ADD CONSTRAINT event_translation_id_event_id FOREIGN KEY (id) REFERENCES event(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE event ADD CONSTRAINT event_vendor_id_vendor_id FOREIGN KEY (vendor_id) REFERENCES vendor(id);
ALTER TABLE event ADD CONSTRAINT event_poi_id_poi_id FOREIGN KEY (poi_id) REFERENCES poi(id);
ALTER TABLE event ADD CONSTRAINT event_event_category_id_event_category_id FOREIGN KEY (event_category_id) REFERENCES event_category(id);
ALTER TABLE event_media ADD CONSTRAINT event_media_event_id_event_id FOREIGN KEY (event_id) REFERENCES event(id);
ALTER TABLE event_occurence ADD CONSTRAINT event_occurence_poi_id_poi_id FOREIGN KEY (poi_id) REFERENCES poi(id);
ALTER TABLE event_occurence ADD CONSTRAINT event_occurence_event_id_event_id FOREIGN KEY (event_id) REFERENCES event(id);
ALTER TABLE event_property ADD CONSTRAINT event_property_poi_id_event_id FOREIGN KEY (poi_id) REFERENCES event(id);
ALTER TABLE movie ADD CONSTRAINT movie_vendor_id_vendor_id FOREIGN KEY (vendor_id) REFERENCES vendor(id);
ALTER TABLE movie_media ADD CONSTRAINT movie_media_movie_id_movie_id FOREIGN KEY (movie_id) REFERENCES movie(id);
ALTER TABLE movie_occurence ADD CONSTRAINT movie_occurence_poi_id_poi_id FOREIGN KEY (poi_id) REFERENCES poi(id);
ALTER TABLE movie_occurence ADD CONSTRAINT movie_occurence_movie_id_movie_id FOREIGN KEY (movie_id) REFERENCES movie(id);
ALTER TABLE movie_property ADD CONSTRAINT movie_property_movie_id_movie_id FOREIGN KEY (movie_id) REFERENCES movie(id);
ALTER TABLE poi_translation ADD CONSTRAINT poi_translation_id_poi_id FOREIGN KEY (id) REFERENCES poi(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE poi ADD CONSTRAINT poi_vendor_id_vendor_id FOREIGN KEY (vendor_id) REFERENCES vendor(id);
ALTER TABLE poi ADD CONSTRAINT poi_poi_parent_category_id_poi_parent_category_id FOREIGN KEY (poi_parent_category_id) REFERENCES poi_parent_category(id);
ALTER TABLE poi ADD CONSTRAINT poi_poi_category_id_poi_category_id FOREIGN KEY (poi_category_id) REFERENCES poi_category(id);
ALTER TABLE poi_category ADD CONSTRAINT poi_category_parent_id_poi_parent_category_id FOREIGN KEY (parent_id) REFERENCES poi_parent_category(id) ON DELETE CASCADE;
ALTER TABLE poi_media ADD CONSTRAINT poi_media_poi_id_poi_id FOREIGN KEY (poi_id) REFERENCES poi(id);
ALTER TABLE poi_property ADD CONSTRAINT poi_property_poi_id_poi_id FOREIGN KEY (poi_id) REFERENCES poi(id);
ALTER TABLE user ADD CONSTRAINT user_vendor_id_vendor_id FOREIGN KEY (vendor_id) REFERENCES vendor(id);
ALTER TABLE user_content ADD CONSTRAINT user_content_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE;
ALTER TABLE user_content ADD CONSTRAINT user_content_poi_id_poi_id FOREIGN KEY (poi_id) REFERENCES poi(id) ON DELETE CASCADE;
