<?php
require_once 'PHPUnit/Framework.php';
require_once dirname(__FILE__).'/../../../../../test/bootstrap/unit.php';
require_once dirname( __FILE__ ) . '/../../../bootstrap.php';

/**
 * Test class for nyMoviesDataMapper.
 * Generated by PHPUnit on 2010-02-16 at 16:30:38.
 */
class LondonDatabaseMoviesDataMapperTest extends PHPUnit_Framework_TestCase
{
  /**
   * @var londonDatabaseFilmsDataMapper
   */
  protected $object;

  /**
   * @var Vendor
   *
   */
  private $vendor;

  private $sqliteDSN;
  /**
   * Sets up the fixture, for example, opens a network connection.
   * This method is called before a test is executed.
   */
  protected function setUp()
  {
    ProjectN_Test_Unit_Factory::createDatabases();
    Doctrine::loadData( 'data/fixtures/fixtures.yml' );

    $this->sqliteDSN =  "mysql:dbname=film_tmp;host=localhost";
    
    // create SQLite DB with DATA
    $this->createDatabase();
  }

  /**
   * Tears down the fixture, for example, closes a network connection.
   * This method is called after a test is executed.
   */
  protected function tearDown()
  {
    ProjectN_Test_Unit_Factory::destroyDatabases();

    // drop the Database
    $this->dropDatabase();
  }

  public function testLondonFilms()
  {
      $vendor = Doctrine::getTable( 'Vendor' )->findOneByCity('london');

      $params = array( 'query' => "c.country_id = '930'", 'review_type_id' => '2', 'database' => array( 'dsn' => $this->sqliteDSN, 'username' => 'root', 'password' => 'outtime99' ) );
      $importer = new Importer();
      $importer->addDataMapper( new londonDatabaseFilmsDataMapper( $vendor, $params ) );
      $importer->run();

      $movies = Doctrine::getTable( 'movie' )->findAll();
      
      $this->assertEquals( 7, $movies->count() );

      // some Movie Details
      $movie = $movies[0];

      $this->assertEquals( '2', $movie['vendor_movie_id']);
      $this->assertEquals( 'Velvet Vampire, The (aka Cemetery Girls/ The Waking Hour)', $movie['name']);
      
      $description = 'Woefully archaic in its British B-pic reliance on very cheap';
      $this->assertEquals( $description, substr($movie['review'], 0 , strlen( $description )) );
  }

  public function testChicagoFilms()
  {
       $vendor = Doctrine::getTable( 'Vendor' )->findOneByCity('chicago');

      $params = array( 'query' => "c.country_id = '931' AND  city_state LIKE '%IL'", 'review_type_id' => '4', 'database' => array( 'dsn' => $this->sqliteDSN, 'username' => 'root', 'password' => 'outtime99' ) );

      $importer = new Importer();
      $importer->addDataMapper( new londonDatabaseFilmsDataMapper( $vendor, $params ) );
      $importer->run();

      $movies = Doctrine::getTable( 'movie' )->findAll();

      $this->assertEquals( 3, $movies->count() );

      // some Movie Details
      $movie = $movies[0];
      $this->assertEquals( '1', $movie['vendor_movie_id']);
      $this->assertEquals( 'Vacances de M. Hulot, Les (Monsieur Hulot\'s Holiday/ Mr Hulot\'s Holiday)', $movie['name']);

      $description = "Tati's most consistently enjoyable comedy, a gentle portrait of the clumsy, well-meaning Hulot on vacation";
      $this->assertEquals( $description, substr($movie['review'], 0 , strlen( $description )) );
  }

  public function testNYFilms()
  {
      $vendor = Doctrine::getTable( 'Vendor' )->findOneByCity('ny');

      $params = array( 'query' => "c.country_id = '931' AND  city_state LIKE '%NY'", 'review_type_id' => '3', 'database' => array( 'dsn' => $this->sqliteDSN, 'username' => 'root', 'password' => 'outtime99' ) );

      $importer = new Importer();
      $importer->addDataMapper( new londonDatabaseFilmsDataMapper( $vendor, $params ) );
      $importer->run();

      $movies = Doctrine::getTable( 'movie' )->findAll();

      $this->assertEquals( 3, $movies->count() );

      // some Movie Details
      $movie = $movies[0];
      $this->assertEquals( '8', $movie['vendor_movie_id']);
      $this->assertEquals( 'Vizi Privati, Pubbliche VirtÃº', $movie['name']);

      $description = "British audiences have thus far shown stoic indifference to the work of Finnish fashion victim";
      $this->assertEquals( $description, substr($movie['review'], 0 , strlen( $description )) );
  }

  /**
   *  Create the TEMPORARY Database in LOCALHOST MySql and Fill with Data for Test
   */
  private function createDatabase()
  {
      // Drop Existing Database
      $this->dropDatabase();
      
      // Create Temporary Database Table
      $conn = mysql_connect('localhost', 'root', 'outtime99');
      if( !$conn )
      {
          throw new Exception( 'Could not connect: ' . mysql_error() );
      }

      // create Database
      if( !mysql_query("CREATE DATABASE film_tmp CHARACTER SET utf8 DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT COLLATE utf8_general_ci;",$conn) )
      {
          throw new Exception( 'Unable to create Database film_tmp ' . mysql_error() );
      }
      // Close the Connection
      mysql_close( $conn );

      try {
          $pdoDB = new PDO( $this->sqliteDSN, 'root', 'outtime99', array(PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8") );

          //$pdoDB->beginTransaction();
          // $pdoDB->commit();
          
          $pdoDB->query( 'DROP TABLE IF EXISTS `certificates`; DROP TABLE IF EXISTS `cinema`; DROP TABLE IF EXISTS `film`; DROP TABLE IF EXISTS `film_certificates`; DROP TABLE IF EXISTS `film_map`; DROP TABLE IF EXISTS `film_release_date`;' );
          $pdoDB->query( 'DROP TABLE IF EXISTS `genre`; DROP TABLE IF EXISTS `genre`; DROP TABLE IF EXISTS `listing`; DROP TABLE IF EXISTS `person`; DROP TABLE IF EXISTS `role`;DROP TABLE IF EXISTS `review`;' );

          // Create the TABLES
          $pdoDB->exec('CREATE TABLE  `certificates` ( `id` int(10), `country_id` int(10),  `name` varchar(255),   `code` varchar(10),  `description` varchar(255),  PRIMARY KEY (`id`) ) CHARACTER SET utf8 COLLATE utf8_general_ci;');
          $pdoDB->exec("CREATE TABLE  `cinema` ( `cinema_id` int(10), `cinema_chain_id` int(10) DEFAULT '0', `name` varchar(255) DEFAULT '', `address` varchar(255) DEFAULT '', `city_state` varchar(255) DEFAULT '', `country_id` int(10) DEFAULT '930', `postcode` varchar(20) DEFAULT NULL, `phone` varchar(255) DEFAULT NULL, `url` varchar(255) DEFAULT NULL, `x` int(10) DEFAULT NULL, `y` int(10) DEFAULT NULL, `status` varchar(255) DEFAULT NULL, `latitude` decimal(9,6) DEFAULT NULL, `longitude` decimal(9,6) DEFAULT NULL, `alias_cinema_id` int(10) DEFAULT '0', PRIMARY KEY (`cinema_id`) ) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `film` (`film_id` int(10),  `year_made` varchar(4) DEFAULT NULL,  `duration` int(10) DEFAULT '0', `title` varchar(255) DEFAULT NULL, `display_title` varchar(255) DEFAULT NULL, `url_title` varchar(255) DEFAULT NULL, `colour` varchar(10) DEFAULT 'col', `year_rereleased` varchar(4) DEFAULT NULL, `year_reviewed` varchar(4) DEFAULT NULL, `film_id_alternative` int(10) DEFAULT NULL, `have_image` int(1) DEFAULT '0', `image_credit` varchar(255) DEFAULT NULL, `image_id` int(10) DEFAULT NULL, `rating_id` int(10) DEFAULT NULL, `popularity` int(10) DEFAULT '0', `updated` varchar(50), PRIMARY KEY (`film_id`) ) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `film_certificates` ( `id` int(10),  `film_id` int(10),  `certificate_id` int(10),  PRIMARY KEY (`id`)) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `film_map` ( `film_map_id` int(10),  `person_id` int(10) DEFAULT '0',  `film_id` int(10) DEFAULT NULL,  `role_id` int(10) DEFAULT NULL,  PRIMARY KEY (`film_map_id`)) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `film_release_date` ( `film_release_id` int(10),  `film_id` int(10) DEFAULT NULL,  `country_id` int(10) DEFAULT NULL,  `release_date` date DEFAULT NULL,  PRIMARY KEY (`film_release_id`) ) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `genre` (  `genre_film_id` int(10),  `film_id` int(10) DEFAULT NULL,  `genre_id` int(10) DEFAULT '0',  PRIMARY KEY (`genre_film_id`) ) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `genre_title` ( `genre_id` int(10),  `genre` varchar(255) DEFAULT NULL,  PRIMARY KEY (`genre_id`)) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `listing` ( `listing_id` int(10),  `listing_source_id` int(10) DEFAULT '0',  `film_id` int(10) DEFAULT '0',  `cinema_id` int(10) DEFAULT '0',  `film_name` varchar(255) DEFAULT NULL,  `extra_text` varchar(255) DEFAULT NULL,  `date` date DEFAULT NULL,  `time` time DEFAULT NULL,  `status` tinyint(4) DEFAULT '0',  `repertory` int(1) DEFAULT '0',  `booking_url` text,  PRIMARY KEY (`listing_id`)) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `person` ( `person_id` int(10),  `name_first` varchar(255) DEFAULT NULL,  `name_second` varchar(255) DEFAULT NULL,  `popularity` int(10) DEFAULT '0',  `url_name_first` varchar(255) DEFAULT NULL,  `url_name_second` varchar(255) DEFAULT NULL,  PRIMARY KEY (`person_id`) ) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `role` ( `role_id` int(10),  `role` varchar(255) DEFAULT NULL,  `label` varchar(255) DEFAULT '',  `display_order` int(2) DEFAULT NULL,  PRIMARY KEY (`role_id`)) CHARACTER SET utf8 COLLATE utf8_general_ci;");
          $pdoDB->exec("CREATE TABLE `review` ( `review_id` int(10) unsigned NOT NULL AUTO_INCREMENT,  `text` text,  `film_id` int(10) unsigned DEFAULT NULL,  `media` enum('DVD','Video','Film') DEFAULT 'Film',  `reviewer` varchar(100) NOT NULL DEFAULT '',  `review_type_id` int(3) NOT NULL DEFAULT '0',  `source` varchar(255) NOT NULL DEFAULT '',  `embargo_ends` datetime DEFAULT NULL,  `embargo_exclusive` int(1) DEFAULT NULL,  `review_date` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',  `rating` int(1),  `rating_dec` int(1) NOT NULL DEFAULT '0',  `updated` varchar(50),  PRIMARY KEY (`review_id`)) CHARACTER SET utf8 COLLATE utf8_general_ci;");

          // add Dummy Data
          // Certificates
          $pdoDB->exec("INSERT INTO `certificates` VALUES(1,930,'Universal : Children','Uc','Suitable for all');");
          $pdoDB->exec("INSERT INTO `certificates` VALUES(2,931,'Universal','U','Suitable for all');");
          $pdoDB->exec("INSERT INTO `certificates` VALUES(3,930,'18','18','Suitable for those aged 18 and over');");
          $pdoDB->exec( "INSERT INTO `certificates` VALUES(4,931,'Not Rated','NR','Rating pending');" );

          // Cinema
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (1,4,'Odeon Dunfermline','1 Whimbrel Place, Fife Leisure Park, Fife','Fife Leisure Park, Fife',930,'KY11 8EX','0871 2244007','http://www.odeon.co.uk/',313100,688100,'active','56.078422','-3.397581',0);" );
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (2,4,'Odeon Edinburgh Lothian Road','118 Lothian Road','118 Lothian Road',930,'EH3 9BG','0871 2244007','http://www.odeon.co.uk/',324700,673100,'active','55.945490','-3.205776',0);" );
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (3,4,'Odeon Edinburgh Wester Hailes','Westside Plaza, 120 Wester Hailes Road','120 Wester Hailes Road',930,'EH14 3HR','0871 2244007','http://www.odeon.co.uk/',319700,669700,'active','55.914159','-3.285554',0);" );
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (4,4,'Odeon Manchester','Printworks Centre, 6-8 Dantzic Street','6-8 Dantzic Street',930,'M4 2AD','0871 2244007','http://www.odeon.co.uk/',384100,398700,'active','53.484884','-2.239765',0);" );
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (5,4,'Odeon Glasgow Springfield Quay','Paisley Road,','Paisley Road,',930,'G5 8NP','0871 2244007','http://www.odeon.co.uk/',257600,664600,'active','55.854223','-4.273501',0)" );
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (6,4,'Odeon Liverpool London Road','London Road','London Road',930,'L3 5NF','0871 2244007','http://www.odeon.co.uk/',335100,390600,'active','53.409070','-2.976442',0);" );
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (7,20,'AMC Northbrook','1525 Lake Cook Road, Northbrook, IL','Northbrook, IL',931,'60062','847-562-1522','',0,0,'active','42.152800','-87.865400',0);");
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (8,31,'I.C.E. 62nd and Western','2258 W. 62nd St., Chicago, IL','Chicago, IL',931,'60636','773-476-4959','',0,0,'active','41.775800','-87.668300',0);");
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (9,42,'Fairfax Five Theatres','9 Broadway, Fairfax, CA','Fairfax, NY',931,'94930','415-453-5444','',0,0,'active','37.986800','-122.586600',0);");
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (10,20,'AMC Theatres Burbank Town Center 8','201 E. Magnolia Blvd., Burbank, CA','Burbank, NY',931,'91501','310-289-4262','',0,0,'active','34.183200','-118.310900',0);");
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (11,16,'AMC ShowPlace 14 - Galewood Crossings ','5530 W Homer St, Chicago, IL','Chicago, IL',931,'60639','773-413-1970','',0,0,'active','41.915990','-87.747280',0);");
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (12,12,'Reel Quinton','Hagley Road West, Quinton, West Midlands','Quinton, West Midlands',930,'B62 9AS','','',0,0,'active','52.462634','-2.014763',0);");
          $pdoDB->exec( "INSERT INTO `cinema` VALUES (13,8,'Hampstead Town Hall','213 Haverstock Hill','213 Haverstock Hill',930,'NW3 4QP','0207 692 5800','',0,0,'active','51.550951','-0.166566',0);");

          // Film
          $pdoDB->exec( "INSERT INTO `film` VALUES (1,1952,0,'Vacances de M. Hulot, Les (Monsieur Hulot\'s Holiday/ Mr Hulot\'s Holiday)','Monsieur Hulot\'s Holiday','Monsieur_Hulot-s_Holiday','b/w',1952,0000,0,0,'',10089738,0,0,'2009-11-17 19:49:23')");
          $pdoDB->exec( "INSERT INTO `film` VALUES (2,1971,80,'Velvet Vampire, The (aka Cemetery Girls/ The Waking Hour)','The Velvet Vampire','The_Velvet_Vampire','col',1971,0000,0,0,'',0,0,4,'2008-04-18 20:05:24');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (3,1969,103,'Vengeance! (Baochou)','Vengeance!','Vengeance','col',1969,0000,0,0,'',0,0,2,'2008-04-14 06:05:24');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (4,0000,0,'Vertical Ray of the Sun','Vertical Ray of the Sun','Vertical_Ray_of_the_Sun','',2000,0000,78292,0,'',0,0,0,'2008-03-06 12:25:27');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (5,1974,110,'Violation of Justine, The (Justine)','The Violation of Justine','The_Violation_of_Justine','col',1974,0000,0,0,'',0,0,45,'2008-04-22 20:05:22');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (6,1977,98,'Violette et FranÃ§ois','Violette et FranÃ§ois','Violette_et_Francois','col',1977,0000,0,0,'',0,0,11,'2008-04-22 20:05:22');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (7,1961,0,'Viridiana','Viridiana','Viridiana','b/w',1961,0000,0,0,'',10018940,0,0,'2009-04-21 19:36:17');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (8,0000,0,'Vizi Privati, Pubbliche VirtÃº','Vizi Privati, Pubbliche VirtÃº','Vizi_Privati_Pubbliche_Virtu','',2000,0000,71474,0,'',0,0,0,'2008-03-06 12:25:27');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (9,1981,89,'National Lampoon Goes to the Movies (aka National Lampoon\'s Movie Madness)','National Lampoon Goes to the Movies','National_Lampoon_Goes_to_the_Movies','col',1981,0000,0,0,'',0,461,14,'2008-04-21 20:05:24')");
          $pdoDB->exec( "INSERT INTO `film` VALUES (10,2006,126,'Private Fears in Public Places','Private Fears in Public Places','Private_Fears_in_Public_Places','col',0000,0000,0,1,'',29564,6137,86,'2008-04-22 20:05:30');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (11,2006,91,'Fido','Fido','Fido','col',0000,0000,0,1,'',0,6158,11,'2008-04-22 20:05:30');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (12,0000,0,'Onna ga kaidan wo agaru toki','Onna ga kaidan wo agaru toki','Onna_ga_kaidan_wo_agaru_toki','col',1960,0000,84342,0,'',0,0,0,'2008-03-06 12:25:27');");
          $pdoDB->exec( "INSERT INTO `film` VALUES (13,0000,0,'Spider-Man 3: The IMAX Experience','Spider-Man 3: The IMAX Experience','Spider-Man_3-The_IMAX_Experience','',0000,0000,0,0,'',0,0,2,'2008-04-17 20:05:30');");

          // film_certificates
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (1,1,2)" ); // US
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (2,2,1)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (3,3,2)" ); // US
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (4,4,2)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (5,5,4)" ); // US
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (6,6,3)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (7,7,1)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (8,8,2)" ); // US
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (9,9,3)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (10,10,3)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (11,11,4)" ); // US
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (12,12,1)" );
          $pdoDB->exec( "INSERT INTO `film_certificates` VALUES  (13,13,4)" ); // US

          // person
          $pdoDB->exec( "INSERT INTO `person` VALUES (1,'Jacques','Tati',31,'Jacques','Tati');" );
          $pdoDB->exec( "INSERT INTO `person` VALUES (2,'Fred','Orain',1,'Fred','Orain');" );
          $pdoDB->exec( "INSERT INTO `person` VALUES (3,'Henri','Marquet',0,'Henri','Marquet');" );
          $pdoDB->exec( "INSERT INTO `person` VALUES (4,'Valentine','Camax',0,'Valentine','Camax');" );
          $pdoDB->exec( "INSERT INTO `person` VALUES (5,'Maria Elena','Sainz',0,'Maria_Elena','Sainz');" );
          $pdoDB->exec( "INSERT INTO `person` VALUES (6,'StÃ©phane','Freiss',14,'Stephane','Freiss');" );

          //role
          $pdoDB->exec( "INSERT INTO `role` VALUES  (1,'d','Director',NULL);" );
          $pdoDB->exec( "INSERT INTO `role` VALUES (2,'p','Producer',NULL);" );
          $pdoDB->exec( "INSERT INTO `role` VALUES (3,'cast','Cast',NULL);" );
          $pdoDB->exec( "INSERT INTO `role` VALUES (4,'m','Music',NULL);" );
          $pdoDB->exec( "INSERT INTO `role` VALUES (5,'voices','Voices',NULL);" );
          
          // Film Map ( ID. Person , Film , Role)
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (1,1,1,1);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (2,2,2,2);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (3,3,3,3);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (4,2,4,1);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (5,6,5,2);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (6,2,5,3);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (7,2,7,4);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (8,4,8,2);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (9,5,9,1);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (10,3,10,3);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (11,2,11,3);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (12,5,12,3);" );
          $pdoDB->exec( "INSERT INTO `film_map` VALUES  (13,1,13,3);" );

          // film_release_date ID, Film, Country, release date
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (1,1,931,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (2,2,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (3,3,931,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (4,4,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (5,5,931,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (6,6,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (7,7,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (8,8,931,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (9,9,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (10,10,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (11,11,931,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (12,12,930,'0000-00-00');" );
          $pdoDB->exec( "INSERT INTO `film_release_date` VALUES  (13,13,931,'0000-00-00');" );

          // genre ID, Film ID, Genre ID
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36531,1,115);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36521,2,116);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36541,3,118);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36551,4,123);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36561,5,124);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36571,6,122);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36581,7,118);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36591,8,119);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36592,9,115);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36533,10,121);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36534,11,122);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36535,12,120);" );
          $pdoDB->exec( "INSERT INTO `genre` VALUES  (36536,13,117);" );

          //genre_title
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (115,'Action/Adventure');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (116,'Children\'s');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (117,'Comedy');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (118,'Documentaries');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (119,'Epics');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (120,'Fantasy');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (121,'Film Noir');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (122,'Gangsters');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (123,'Horror');" );
          $pdoDB->exec( "INSERT INTO `genre_title` VALUES (124,'Musicals');" );

          // listing , ID, listing_source_id, film_id, cinema_id, film_name, extra_text
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145324026,15,1,7,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','21:40:00',0,0,'http://www.fandango.com/tms.asp?t=AAJKL&m=84842&d=2010-09-30&a=11709');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145485261,15,2,1,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','14:40:00',2,0,'http://www.fandango.com/tms.asp?t=AAOZM&m=91872&d=2010-09-27&a=11709');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145324032,15,3,8,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','13:20:00',0,0,'http://www.fandango.com/tms.asp?t=AAMIA&m=84842&d=2010-09-26&a=11709');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145324047,15,4,2,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','22:35:00',0,0,'http://www.fandango.com/tms.asp?t=AAMIA&m=84842&d=2010-09-29&a=11709');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145485255,15,5,11,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','13:15:00',2,0,'');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145324068,15,6,3,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','15:50:00',0,0,'');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145324078,15,7,4,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','20:15:00',0,0,'');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145485247,15,8,9,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','22:15:00',2,0,'');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145485241,15,9,5,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','22:15:00',2,0,'');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145485238,15,10,6,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','15:30:00',2,0,'');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145324117,15,11,10,'',NULL,'".date('Y-m-d', strtotime('+5 day'))."','22:30:00',0,0,'http://www.fandango.com/tms.asp?t=AAODV&m=84842&d=2010-09-27&a=11709');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145429190,21,12,12,'','','".date('Y-m-d', strtotime('+5 day'))."','14:10:00',2,0,'http://www.cineworld.co.uk/booking?performance=2293314');" );
          $pdoDB->exec( "INSERT INTO `listing` VALUES  (145429194,21,13,9,'','','".date('Y-m-d', strtotime('+5 day'))."','21:30:00',2,0,'http://www.cineworld.co.uk/booking?performance=2293185');" );

          // Review 1=Chicago, 2 = London 13 = NY
          $pdoDB->exec( "INSERT INTO `review` VALUES (1,'Tati\'s most consistently enjoyable comedy, a gentle portrait of the clumsy, well-meaning Hulot on vacation in a provincial seaside resort. The quiet, delicately observed slapstick here works with far more hits than misses, although in comparison with, say, Keaton, Tati\'s cold detachment from his characters seems to result in a decided lack of insight into human behaviour. But at least in contrast to later works like <I>Playtime</I> and <I>Traffic</I>, there\'s enough dramatic structure to make it more than simply a series of one-off gags.',1,'Film','GA',4,'13','0000-00-00 00:00:00',0,'0000-00-00 00:00:00','none',0,'2008-03-06 12:25:47');" );
          $pdoDB->exec( "INSERT INTO `review` VALUES (2,'Woefully archaic in its British B-pic reliance on very cheap thrills and very worn dramatic clichÃ©s, and without any self-parodic saving grace, <I>Venom</I> spells box-office poison. A kidnapped kid, a killer snake loose in the house, sibilant Teuton Kinski and sneering Bulldog Reed hamming villainy against each other, and <!-- name_start -->Nicol Williamson<!-- name_end:282562:nicol-williamson --> the sorely tried bobby out in the sealed-off London street. Get the picture? There is more (by way of disgressive star turns, that is), but never enough to raise a glimmer of interest or tension in the static rituals of siege cinema.',2,'Film','PT',2,'13','0000-00-00 00:00:00',0,'0000-00-00 00:00:00','none',0,'2008-03-06 12:25:47');");
          $pdoDB->exec( "INSERT INTO `review` VALUES (3,'British audiences have thus far shown stoic indifference to the work of Finnish fashion victim KaurismÃ¤ki, and this straight-faced adaptation of Henri Murger\'s melodramatic novel (1851) is unlikely to quicken their pulses. A polyglot cast (most of them long-haired Finns) enact the depressed lives of failed artists and their consumptive muse Mimi in fractured French, spurred on by names from the director\'s address-book and a dog named Baudelaire. The one-note joke palls fast, and KaurismÃ¤ki\'s endless quest for emotional truth at the heart of miserabilist clichÃ©s winds up in its usual cul-de-sac.',8,'Film','TR',3,'13','0000-00-00 00:00:00',0,'0000-00-00 00:00:00','none',0,'2008-03-06 12:25:47');");


          $pdoDB = null; // Close the Connection

      }catch(PDOException $e)
      {
          echo 'PDO Connection Exception: ' . $e->getMessage() . PHP_EOL;
      }

  }

  /**
   * DROP the Temporary Database From LOCALHOST MySql
   */
  private function dropDatabase()
  {
      // Create Temporary Database Table
      $conn = mysql_connect('localhost', 'root', 'outtime99');
      if( !$conn )
      {
          throw new Exception( 'Could not connect: ' . mysql_error() );
      }

      // create Database
      if( !mysql_query("DROP DATABASE IF EXISTS film_tmp",$conn) )
      {
          throw new Exception( 'Unable to drop Database film_tmp ' . mysql_error() );
      }
      // Close the Connection
      mysql_close( $conn );
  }
}
